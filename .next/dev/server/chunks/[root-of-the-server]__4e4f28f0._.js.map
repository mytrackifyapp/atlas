{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ekaygabriel/Downloads/trackify-ventures-ui/app/api/chat/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\n\nconst GROQ_API_URL = \"https://api.groq.com/openai/v1/chat/completions\"\nconst FINNA_SYSTEM_PROMPT = `You are Finna, the AI assistant for Trackify Atlasâ€”a platform for investors and founders in the African startup ecosystem.\n\nYour role:\n- Help users understand Trackify Atlas: portfolio analytics, deal flow, fundraising tools, and market intelligence.\n- Answer questions about features for investors (portfolio tracking, deal scoring, pipeline management) and founders (investor pipeline, data room, fundraising tracker, cap table, metrics).\n- Provide concise, friendly, and accurate answers. If you don't know something specific about their data or product, say so and suggest they check the dashboard or docs.\n- Keep responses focused and not overly long unless the user asks for detail.\n- You can suggest next steps (e.g. \"Try the Portfolio view\" or \"Check out the Fundraising Tracker\") when relevant.`\n\nexport type ChatMessage = { role: \"user\" | \"assistant\"; content: string }\n\nexport async function POST(request: NextRequest) {\n  try {\n    const apiKey = process.env.GROQ_API_KEY\n    if (!apiKey) {\n      return NextResponse.json(\n        { error: \"Finna AI is not configured. Add GROQ_API_KEY to your environment.\" },\n        { status: 503 }\n      )\n    }\n\n    const body = await request.json()\n    const messages = body.messages as ChatMessage[] | undefined\n    if (!Array.isArray(messages) || messages.length === 0) {\n      return NextResponse.json(\n        { error: \"Request must include a non-empty messages array.\" },\n        { status: 400 }\n      )\n    }\n\n    const groqMessages = [\n      { role: \"system\" as const, content: FINNA_SYSTEM_PROMPT },\n      ...messages.map((m) => ({ role: m.role, content: m.content })),\n    ]\n\n    const res = await fetch(GROQ_API_URL, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${apiKey}`,\n      },\n      body: JSON.stringify({\n        model: \"llama-3.3-70b-versatile\",\n        messages: groqMessages,\n        max_tokens: 1024,\n        temperature: 0.6,\n      }),\n    })\n\n    if (!res.ok) {\n      const errText = await res.text()\n      console.error(\"Groq API error:\", res.status, errText)\n      return NextResponse.json(\n        { error: \"Finna is temporarily unavailable. Please try again.\" },\n        { status: 502 }\n      )\n    }\n\n    const data = (await res.json()) as {\n      choices?: Array<{ message?: { content?: string } }>\n    }\n    const content =\n      data.choices?.[0]?.message?.content?.trim() ??\n      \"I couldn't generate a response. Please try again.\"\n\n    return NextResponse.json({ content })\n  } catch (error) {\n    console.error(\"Chat API error:\", error)\n    return NextResponse.json(\n      { error: \"Something went wrong. Please try again.\" },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,eAAe;AACrB,MAAM,sBAAsB,CAAC;;;;;;;kHAOqF,CAAC;AAI5G,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,SAAS,QAAQ,GAAG,CAAC,YAAY;QACvC,IAAI,CAAC,QAAQ;YACX,OAAO,gRAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoE,GAC7E;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,WAAW,KAAK,QAAQ;QAC9B,IAAI,CAAC,MAAM,OAAO,CAAC,aAAa,SAAS,MAAM,KAAK,GAAG;YACrD,OAAO,gRAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAmD,GAC5D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,eAAe;YACnB;gBAAE,MAAM;gBAAmB,SAAS;YAAoB;eACrD,SAAS,GAAG,CAAC,CAAC,IAAM,CAAC;oBAAE,MAAM,EAAE,IAAI;oBAAE,SAAS,EAAE,OAAO;gBAAC,CAAC;SAC7D;QAED,MAAM,MAAM,MAAM,MAAM,cAAc;YACpC,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,eAAe,CAAC,OAAO,EAAE,QAAQ;YACnC;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO;gBACP,UAAU;gBACV,YAAY;gBACZ,aAAa;YACf;QACF;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,UAAU,MAAM,IAAI,IAAI;YAC9B,QAAQ,KAAK,CAAC,mBAAmB,IAAI,MAAM,EAAE;YAC7C,OAAO,gRAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsD,GAC/D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAQ,MAAM,IAAI,IAAI;QAG5B,MAAM,UACJ,KAAK,OAAO,EAAE,CAAC,EAAE,EAAE,SAAS,SAAS,UACrC;QAEF,OAAO,gRAAY,CAAC,IAAI,CAAC;YAAE;QAAQ;IACrC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gRAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA0C,GACnD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}